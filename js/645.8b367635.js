"use strict";(self["webpackChunkcare"]=self["webpackChunkcare"]||[]).push([[645],{66645:(e,o,l)=>{l.r(o),l.d(o,{default:()=>M});var t=l(83673),a=l(98880),r=l(62323);const i=(0,t._)("h1",{class:"text-h4"},"Payrolls",-1),n={class:"row",style:{"margin-bottom":"15px"}},d={class:"col",style:{"padding-right":"10px"}},u=(0,t.Uk)(" No results "),s={class:"col",style:{"padding-left":"10px"}},p={class:"row items-center justify-end"},v=(0,t.Uk)("Summary");function w(e,o,l,w,c,m){const y=(0,t.up)("q-item-section"),f=(0,t.up)("q-item"),g=(0,t.up)("q-select"),k=(0,t.up)("q-btn"),h=(0,t.up)("q-date"),_=(0,t.up)("q-popup-proxy"),x=(0,t.up)("q-icon"),W=(0,t.up)("q-input"),b=(0,t.up)("q-form"),U=(0,t.up)("q-td"),Z=(0,t.up)("q-tr"),S=(0,t.up)("q-table"),F=(0,t.up)("q-card-section"),z=(0,t.up)("q-card"),Q=(0,t.up)("q-page"),q=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(Q,{class:"items-center justify-evenly",style:{padding:"40px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(z,null,{default:(0,t.w5)((()=>[(0,t.Wm)(F,null,{default:(0,t.w5)((()=>[i,(0,t.Wm)(b,{style:{width:"100%"},onSubmit:(0,a.iM)(e.onSubmit,["stop"])},{default:(0,t.w5)((()=>[(0,t._)("div",n,[(0,t._)("div",d,[(0,t.Wm)(g,{modelValue:e.user,"onUpdate:modelValue":o[0]||(o[0]=o=>e.user=o),label:"Staff",options:e.options,style:{width:"100%"}},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(f,null,{default:(0,t.w5)((()=>[(0,t.Wm)(y,{class:"text-grey"},{default:(0,t.w5)((()=>[u])),_:1})])),_:1})])),_:1},8,["modelValue","options"])]),(0,t._)("div",s,[(0,t.Wm)(W,{label:"Date Range *","model-value":e.dateRangeFormatted},{append:(0,t.w5)((()=>[(0,t.Wm)(x,{name:"event",class:"cursor-pointer"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{"transition-show":"scale","transition-hide":"scale"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{range:"",modelValue:e.dateRange,"onUpdate:modelValue":o[1]||(o[1]=o=>e.dateRange=o),mask:"YYYY-MM-DD"},{default:(0,t.w5)((()=>[(0,t._)("div",p,[(0,t.wy)((0,t.Wm)(k,{label:"Close",color:"primary",flat:""},null,512),[[q]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["model-value"])])]),(0,t.Wm)(k,{label:"Load Timesheet",type:"submit",color:"primary",loading:e.loading,disable:!e.canSubmit},null,8,["loading","disable"])])),_:1},8,["onSubmit"]),(0,t.Wm)(S,{style:{"margin-top":"30px"},rows:e.rows,"row-key":"name",title:"Timesheet",color:"primary",loading:e.loading,"hide-pagination":!0,pagination:{rowsPerPage:100}},(0,t.Nv)({body:(0,t.w5)((e=>[(0,t.Wm)(Z,{props:e},{default:(0,t.w5)((()=>[(0,t.Wm)(U,{key:"date",props:e},{default:(0,t.w5)((()=>{var o,l,a,i;return[(0,t.Uk)((0,r.zw)(null===e||void 0===e||null===(o=e.row)||void 0===o?void 0:o.date)+" "+(0,r.zw)((null===e||void 0===e||null===(l=e.row)||void 0===l?void 0:l.holiday)>0?"(PUB)":(null===e||void 0===e||null===(a=e.row)||void 0===a?void 0:a.sunday)>0?"(SUN)":(null===e||void 0===e||null===(i=e.row)||void 0===i?void 0:i.saturday)>0?"(SAT)":""),1)]})),_:2},1032,["props"]),(0,t.Wm)(U,{key:"weekday",props:e},{default:(0,t.w5)((()=>{var o;return[(0,t.Uk)((0,r.zw)(null===e||void 0===e||null===(o=e.row)||void 0===o?void 0:o.weekday.toFixed(2)),1)]})),_:2},1032,["props"]),(0,t.Wm)(U,{key:"saturday",props:e},{default:(0,t.w5)((()=>{var o;return[(0,t.Uk)((0,r.zw)(null===e||void 0===e||null===(o=e.row)||void 0===o?void 0:o.saturday.toFixed(2)),1)]})),_:2},1032,["props"]),(0,t.Wm)(U,{key:"sunday",props:e},{default:(0,t.w5)((()=>{var o;return[(0,t.Uk)((0,r.zw)(null===e||void 0===e||null===(o=e.row)||void 0===o?void 0:o.sunday.toFixed(2)),1)]})),_:2},1032,["props"]),(0,t.Wm)(U,{key:"holiday",props:e},{default:(0,t.w5)((()=>{var o;return[(0,t.Uk)((0,r.zw)(null===e||void 0===e||null===(o=e.row)||void 0===o?void 0:o.holiday.toFixed(2)),1)]})),_:2},1032,["props"]),(0,t.Wm)(U,{key:"total",props:e},{default:(0,t.w5)((()=>{var o;return[(0,t.Uk)((0,r.zw)(null===e||void 0===e||null===(o=e.row)||void 0===o?void 0:o.total.toFixed(2)),1)]})),_:2},1032,["props"]),(0,t.Wm)(U,{key:"mileage",props:e},{default:(0,t.w5)((()=>{var o;return[(0,t.Uk)((0,r.zw)(null===e||void 0===e||null===(o=e.row)||void 0===o?void 0:o.mileage),1)]})),_:2},1032,["props"]),(0,t.Wm)(U,{key:"parking",props:e},{default:(0,t.w5)((()=>{var o;return[(0,t.Uk)((0,r.zw)(null===e||void 0===e||null===(o=e.row)||void 0===o?void 0:o.parking),1)]})),_:2},1032,["props"])])),_:2},1032,["props"])])),_:2},[e.rows.length>0?{name:"top-right",fn:(0,t.w5)((()=>[(0,t.Wm)(k,{color:"primary","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:e.exportTable},null,8,["onClick"])]))}:void 0,e.rows.length>0?{name:"top-row",fn:(0,t.w5)((()=>[(0,t.Wm)(Z,{style:{background:"#eee","font-weight":"bold"}},{default:(0,t.w5)((()=>[(0,t.Wm)(U,null,{default:(0,t.w5)((()=>[v])),_:1}),(0,t.Wm)(U,{class:"text-right"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,r.zw)(e.rows.reduce(((e,o)=>e+o.weekday),0).toFixed(2)),1)])),_:1}),(0,t.Wm)(U,{class:"text-right"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,r.zw)(e.rows.reduce(((e,o)=>e+o.saturday),0).toFixed(2)),1)])),_:1}),(0,t.Wm)(U,{class:"text-right"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,r.zw)(e.rows.reduce(((e,o)=>e+o.sunday),0).toFixed(2)),1)])),_:1}),(0,t.Wm)(U,{class:"text-right"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,r.zw)(e.rows.reduce(((e,o)=>e+o.holiday),0).toFixed(2)),1)])),_:1}),(0,t.Wm)(U,{class:"text-right"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,r.zw)(e.rows.reduce(((e,o)=>e+o.total),0).toFixed(2)),1)])),_:1}),(0,t.Wm)(U,{class:"text-right"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,r.zw)(e.rows.reduce(((e,o)=>e+o.mileage),0).toFixed(2)),1)])),_:1}),(0,t.Wm)(U,{class:"text-right"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,r.zw)(e.rows.reduce(((e,o)=>e+o.parking),0).toFixed(2)),1)])),_:1})])),_:1})]))}:void 0]),1032,["rows","loading"])])),_:1})])),_:1})])),_:1})}var c=l(61959),m=l(26999),y=l(12841),f=l(48825),g=l(85998),k=function(e,o,l,t){function a(e){return e instanceof l?e:new l((function(o){o(e)}))}return new(l||(l=Promise))((function(l,r){function i(e){try{d(t.next(e))}catch(o){r(o)}}function n(e){try{d(t["throw"](e))}catch(o){r(o)}}function d(e){e.done?l(e.value):a(e.value).then(i,n)}d((t=t.apply(e,o||[])).next())}))};const h=(0,t.aZ)({components:{},setup(){const e=(0,f.Z)(),o=(0,c.iH)(!1),l=(0,c.iH)({from:"",to:""}),t=(0,c.iH)(null),a=(0,c.iH)([]),r=(0,c.iH)([]),i=(0,c.Fl)((()=>{var e,o,t,a;return(null===(e=l.value)||void 0===e?void 0:e.from)&&(null===(o=l.value)||void 0===o?void 0:o.to)?`${null===(t=l.value)||void 0===t?void 0:t.from} - ${null===(a=l.value)||void 0===a?void 0:a.to}`:""})),n=(0,c.Fl)((()=>{var e;return(null===(e=t.value)||void 0===e?void 0:e.value)&&l.value.from&&l.value.to}));function d(){var e;return k(this,void 0,void 0,(function*(){o.value=!0;try{const a=l.value.from.replace(/\//g,"-"),i=l.value.to.replace(/\//g,"-"),n=yield m.Z.getUserShifts({user_id:null===(e=t.value)||void 0===e?void 0:e.value,from:a,to:i});r.value=n}finally{setTimeout((()=>{o.value=!1}),500)}}))}function u(){var o;const a=["Date","Weekday","Saturday","Sunday","Holiday","Total","Mileage","Parking"],i={fields:a},n=new g.Parser(i),d=n.parse(r.value.map((e=>({Date:e.date,Weekday:e.weekday,Saturday:e.saturday,Sunday:e.sunday,Holiday:e.holiday,Total:e.total,Mileage:e.mileage,Parking:e.parking})))),u=(0,y.Z)(`${null===(o=t.value)||void 0===o?void 0:o.label}_${l.value.from}_${l.value.to}.csv`,d,"text/csv");!0!==u&&e.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}return m.Z.getUsers().then((e=>{a.value=e.map((e=>({label:e.name,value:e.id})))})).catch((e=>{console.log(e)})),{loading:o,user:t,dateRange:l,dateRangeFormatted:i,options:a,rows:r,canSubmit:n,onSubmit:d,exportTable:u}}});var _=l(24379),x=l(10151),W=l(25589),b=l(68689),U=l(55666),Z=l(83414),S=l(52035),F=l(64689),z=l(24554),Q=l(83944),q=l(93124),P=l(64607),T=l(22659),C=l(18186),H=l(83884),D=l(60677),R=l(7518),V=l.n(R);h.render=w;const M=h;V()(h,"components",{QPage:_.Z,QCard:x.Z,QCardSection:W.Z,QForm:b.Z,QSelect:U.Z,QItem:Z.Z,QItemSection:S.Z,QInput:F.Z,QIcon:z.Z,QPopupProxy:Q.Z,QDate:q.Z,QBtn:P.Z,QTable:T.Z,QTr:C.Z,QTd:H.Z}),V()(h,"directives",{ClosePopup:D.Z})}}]);